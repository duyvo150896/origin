--雷虎装备判断
Include("\\script\\newbattles\\functions.lua");

tJunGongBattleEquip = 
{
	[SONG_ID] = {
		--{{item_name,g,d,p},军功需求}
		{{"Tng Li H?Dng S?Khi",0,103,30211},120000},
		{{"Tng Li H?Dng S?Khi",0,103,30212},120000},
		{{"Tng Li H?Dng S?Khi",0,103,30213},120000},
		{{"Tng Li H?Dng S?Khi",0,103,30214},120000},
		
		{{"Tng Li H?Dng S?Bo",0,100,30211},120000},
		{{"Tng Li H?Dng S?Bo",0,100,30212},120000},
		{{"Tng Li H?Dng S?Bo",0,100,30213},120000},
		{{"Tng Li H?Dng S?Bo",0,100,30214},120000},
		
		{{"Tng Li H?Dng S?Trang",0,101,30211},120000},
		{{"Tng Li H?Dng S?Trang",0,101,30212},120000},
		{{"Tng Li H?Dng S?Trang",0,101,30213},120000},
		{{"Tng Li H?Dng S?Trang",0,101,30214},120000},
		
		{{"Tng Li H?Dng S?Hiu K?,0,102,30149"},120000},
		{{"Tng Li H?Dng S?Hiu K?,0,102,30150"},120000},
		{{"Tng Li H?Dng S?Hiu K?,0,102,30151"},120000},
		{{"Tng Li H?Dng S?Hiu K?,0,102,30152"},120000},
		
		{{"Tng Li H?Dng S?Ph?,0,102,30153"},120000},
		{{"Tng Li H?Dng S?Ph?,0,102,30154"},120000},
		{{"Tng Li H?Dng S?Ph?,0,102,30155"},120000},
		{{"Tng Li H?Dng S?Ph?,0,102,30156"},120000},
		
		{{"Tng Li H?Tng Khi",0,103,30215},800000},
        {{"Tng Li H?Tng Khi",0,103,30216},800000},
        {{"Tng Li H?Tng Khi",0,103,30217},800000},
        {{"Tng Li H?Tng Khi",0,103,30218},800000},
        {{"Tng Li H?Soi Khi",0,103,30219},1200000},
        {{"Tng Li H?Soi Khi",0,103,30220},1200000},
        {{"Tng Li H?Soi Khi",0,103,30221},1200000},
        {{"Tng Li H?Soi Khi",0,103,30222},1200000},
        {{"Tng Li H?Tng Bo",0,100,30215},800000},
        {{"Tng Li H?Tng Bo",0,100,30216},800000},
        {{"Tng Li H?Tng Bo",0,100,30217},800000},
        {{"Tng Li H?Tng Bo",0,100,30218},800000},
        {{"Tng Li H?Soi Bo",0,100,30219},1200000},
        {{"Tng Li H?Soi Bo",0,100,30220},1200000},
        {{"Tng Li H?Soi Bo",0,100,30221},1200000},
        {{"Tng Li H?Soi Bo",0,100,30222},1200000},
        {{"Tng Li H?Tng Trang",0,101,30215},800000},
        {{"Tng Li H?Tng Trang",0,101,30216},800000},
        {{"Tng Li H?Tng Trang",0,101,30217},800000},
        {{"Tng Li H?Tng Trang",0,101,30218},800000},
        {{"Tng Li H?Soi Trang",0,101,30219},1200000},
        {{"Tng Li H?Soi Trang",0,101,30220},1200000},
        {{"Tng Li H?Soi Trang",0,101,30221},1200000},
        {{"Tng Li H?Soi Trang",0,101,30222},1200000},
        {{"Tng Li H?Tng Bi",0,102,30157},800000},
        {{"Tng Li H?Tng Bi",0,102,30158},800000},
        {{"Tng Li H?Tng Bi",0,102,30159},800000},
        {{"Tng Li H?Tng Bi",0,102,30160},800000},
        {{"Tng Li H?Tng K?,0,102,30161"},800000},
        {{"Tng Li H?Tng K?,0,102,30162"},800000},
        {{"Tng Li H?Tng K?,0,102,30163"},800000},
        {{"Tng Li H?Tng K?,0,102,30164"},800000},
        {{"Tng Li H?Tng Ph?,0,102,30165"},800000},
        {{"Tng Li H?Tng Ph?,0,102,30166"},800000},
        {{"Tng Li H?Tng Ph?,0,102,30167"},800000},
        {{"Tng Li H?Tng Ph?,0,102,30168"},800000},
        {{"Tng Li H?Soi Ph?,0,102,30169"},1200000},
        {{"Tng Li H?Soi Ph?,0,102,30170"},1200000},
        {{"Tng Li H?Soi Ph?,0,102,30171"},1200000},
        {{"Tng Li H?Soi Ph?,0,102,30172"},1200000},
        {{"Tng Li H?Soi H?Ph?,0,102,30173"},1200000},
        {{"Tng Li H?Soi H?Ph?,0,102,30174"},1200000},
        {{"Tng Li H?Soi H?Ph?,0,102,30175"},1200000},
        {{"Tng Li H?Soi H?Ph?,0,102,30176"},1200000},
        {{"Tng Li H?Soi K?,0,102,30177"},1200000},
        {{"Tng Li H?Soi K?,0,102,30178"},1200000},
        {{"Tng Li H?Soi K?,0,102,30179"},1200000},
        {{"Tng Li H?Soi K?,0,102,30180"},1200000},
        {{"Tng Li H?Soi Hiu K?,0,102,30181"},1200000},
        {{"Tng Li H?Soi Hiu K?,0,102,30182"},1200000},
        {{"Tng Li H?Soi Hiu K?,0,102,30183"},1200000},
        {{"Tng Li H?Soi Hiu K?,0,102,30184"},1200000},
	},
		
	[LIAO_ID] = {
		{{"Liu Li H?Dng S?Khi",0,103,30223},120000},
		{{"Liu Li H?Dng S?Khi",0,103,30224},120000},
		{{"Liu Li H?Dng S?Khi",0,103,30225},120000},
		{{"Liu Li H?Dng S?Khi",0,103,30226},120000},
		
		{{"Liu Li H?Dng S?Bo",0,100,30223},120000},
		{{"Liu Li H?Dng S?Bo",0,100,30224},120000},
		{{"Liu Li H?Dng S?Bo",0,100,30225},120000},
		{{"Liu Li H?Dng S?Bo",0,100,30226},120000},
		
		{{"Liu Li H?Dng S?Trang",0,101,30223},120000},
		{{"Liu Li H?Dng S?Trang",0,101,30224},120000},
		{{"Liu Li H?Dng S?Trang",0,101,30225},120000},
		{{"Liu Li H?Dng S?Trang",0,101,30226},120000},
		
		{{"Liu Li H?Dng S?Hiu K?,0,102,30185"},120000},
		{{"Liu Li H?Dng S?Hiu K?,0,102,30186"},120000},
		{{"Liu Li H?Dng S?Hiu K?,0,102,30187"},120000},
		{{"Liu Li H?Dng S?Hiu K?,0,102,30188"},120000},
		
		{{"Liu Li H?Dng S?Ph?,0,102,30189"},120000},
		{{"Liu Li H?Dng S?Ph?,0,102,30190"},120000},
		{{"Liu Li H?Dng S?Ph?,0,102,30191"},120000},
		{{"Liu Li H?Dng S?Ph?,0,102,30192"},120000},
		
		{{"Liu Li H?Tng Khi",0,103,30227},800000},
        {{"Liu Li H?Tng Khi",0,103,30228},800000},
        {{"Liu Li H?Tng Khi",0,103,30229},800000},
        {{"Liu Li H?Tng Khi",0,103,30230},800000},
        {{"Liu Li H?Soi Khi",0,103,30231},1200000},
        {{"Liu Li H?Soi Khi",0,103,30232},1200000},
        {{"Liu Li H?Soi Khi",0,103,30233},1200000},
        {{"Liu Li H?Soi Khi",0,103,30234},1200000},
        {{"Liu Li H?Tng Bo",0,100,30227},800000},
        {{"Liu Li H?Tng Bo",0,100,30228},800000},
        {{"Liu Li H?Tng Bo",0,100,30229},800000},
        {{"Liu Li H?Tng Bo",0,100,30230},800000},
        {{"Liu Li H?Soi Bo",0,100,30231},1200000},
        {{"Liu Li H?Soi Bo",0,100,30232},1200000},
        {{"Liu Li H?Soi Bo",0,100,30233},1200000},
        {{"Liu Li H?Soi Bo",0,100,30234},1200000},
        {{"Liu Li H?Tng Trang",0,101,30227},800000},
        {{"Liu Li H?Tng Trang",0,101,30228},800000},
        {{"Liu Li H?Tng Trang",0,101,30229},800000},
        {{"Liu Li H?Tng Trang",0,101,30230},800000},
        {{"Liu Li H?Soi Trang",0,101,30231},1200000},
        {{"Liu Li H?Soi Trang",0,101,30232},1200000},
        {{"Liu Li H?Soi Trang",0,101,30233},1200000},
        {{"Liu Li H?Soi Trang",0,101,30234},1200000},
        {{"Liu Li H?Tng Bi",0,102,30193},800000},
        {{"Liu Li H?Tng Bi",0,102,30194},800000},
        {{"Liu Li H?Tng Bi",0,102,30195},800000},
        {{"Liu Li H?Tng Bi",0,102,30196},800000},
        {{"Liu Li H?Tng K?,0,102,30197"},800000},
        {{"Liu Li H?Tng K?,0,102,30198"},800000},
        {{"Liu Li H?Tng K?,0,102,30199"},800000},
        {{"Liu Li H?Tng K?,0,102,30200"},800000},
        {{"Liu Li H?Tng Ph?,0,102,30201"},800000},
        {{"Liu Li H?Tng Ph?,0,102,30202"},800000},
        {{"Liu Li H?Tng Ph?,0,102,30203"},800000},
        {{"Liu Li H?Tng Ph?,0,102,30204"},800000},
        {{"Liu Li H?Soi Ph?,0,102,30205"},1200000},
        {{"Liu Li H?Soi Ph?,0,102,30206"},1200000},
        {{"Liu Li H?Soi Ph?,0,102,30207"},1200000},
        {{"Liu Li H?Soi Ph?,0,102,30208"},1200000},
        {{"Liu Li H?Soi H?Ph?,0,102,30209"},1200000},
        {{"Liu Li H?Soi H?Ph?,0,102,30210"},1200000},
        {{"Liu Li H?Soi H?Ph?,0,102,30211"},1200000},
        {{"Liu Li H?Soi H?Ph?,0,102,30212"},1200000},
        {{"Liu Li H?Soi K?,0,102,30213"},1200000},
        {{"Liu Li H?Soi K?,0,102,30214"},1200000},
        {{"Liu Li H?Soi K?,0,102,30215"},1200000},
        {{"Liu Li H?Soi K?,0,102,30216"},1200000},
        {{"Liu Li H?Soi Hiu K?,0,102,30217"},1200000},
        {{"Liu Li H?Soi Hiu K?,0,102,30218"},1200000},
        {{"Liu Li H?Soi Hiu K?,0,102,30219"},1200000},
        {{"Liu Li H?Soi Hiu K?,0,102,30220"},1200000},
	},
}

function CanEquip(nItemIdx)
	if check_palyer_jungong_equip_state(nItemIdx) == 0 then
		return 1;	--不能穿
	end;
	return 0;
end;

function OnUse(nItemIdx)
	return 0;
end;

function OnEquip()
	return 0;
end

function OnUnEquip()
	return 0;
end

--script\global\verify_equip.luas使用
function verify_equip_battle_jungong_equip(nG, nD, nP)
	local i,j = get_jungong_equip_index_in_table_by_gdp(nG, nD, nP)
end

function get_jungong_equip_index_in_table_by_gdp(nG, nD, nP)
	for i=1,getn(tJunGongBattleEquip) do 
		for j=1,getn(tJunGongBattleEquip[i]) do
			local tEquipInfo = tJunGongBattleEquip[i][j][1];
			if tEquipInfo[2] == nG and tEquipInfo[3] == nD and tEquipInfo[4] == nP then
				return i,j;	--阵营，在table中的索引
			end;
		end;
	end;
	return 0,0;
end

--获得装备的阵营及在table中的索引
function get_jungong_equip_index_intable(nItemIdx)
	local nGenre = GetItemGenre(nItemIdx);
	local nDetail = GetItemDetail(nItemIdx);
	local nParticular = GetItemParticular(nItemIdx);
	return get_jungong_equip_index_in_table_by_gdp(nGenre, nDetail, nParticular)
end;

function check_palyer_jungong_equip_state(nItemIdx,bDisableLog)
	local nEquipCamp,nEquipIdx = get_jungong_equip_index_intable(nItemIdx);
	return check_palyer_jungong_equip_state_by_index(nEquipCamp,nEquipIdx,bDisableLog)
end;

function check_palyer_jungong_equip_state_by_index(nEquipCamp,nEquipIdx,bDisableLog)
	if nEquipCamp == 0 then
		Msg2Player("Зy khng phi l?trang b?chin trn ");
		return 1;
	end;
	local nPlayerCamp = BT_GetCurCamp()
	local nCurPoint = abs(BT_GetData(PT_RANKPOINT));
	
	local tEquipInfo = tJunGongBattleEquip[nEquipCamp][nEquipIdx]
	local sEquipName = tEquipInfo[1][1]
	local nNeedPoint = tEquipInfo[2];
	
	if nPlayerCamp == ALL_ID then
		Msg2Player("Qun hm ca bn hin mi l?Binh s? khng th?nhn trang b?"..sEquipName)
		return 0;	
	end;
	
	if (nEquipCamp ~= nPlayerCamp) then
		if nPlayerCamp == SONG_ID then
			Msg2Player("Ngi l?phe Tng, khng th?mc trang b?phe Liu");
		else
			Msg2Player("Ngi l?phe Liu, khng th?mc trang b?phe Tng");
		end;
		return 0;
	end;
	
	if nCurPoint < nNeedPoint then
		if not bDisableLog or bDisableLog ~= 1 then
			Msg2Player(format("Qun cng ca ngi khng  %d khng th?trang b?%s", nNeedPoint, sEquipName));
		end
		return 0;
	end;
	return 1;
end
